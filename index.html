<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"/>
  <title>Calendrier Bassa'a Perp√©tuel - NGAAKEK KOM BOGA</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#1a5c2e">
  <style>
    /* RESET COMPLET POUR COMPATIBILIT√â */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      -webkit-text-size-adjust: 100%;
      -moz-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
      text-size-adjust: 100%;
    }
    
    html {
      height: 100%;
      width: 100%;
      overflow-x: hidden;
      font-size: 16px;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #0b3d1a 0%, #1a5c2e 100%);
      color: #f0f7da;
      min-height: 100vh;
      min-height: -webkit-fill-available;
      width: 100%;
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    /* HEADER */
    .header {
      text-align: center;
      width: 100%;
      max-width: 1400px;
      margin-bottom: 15px;
      padding: 0 5px;
    }
    
    .header h1 {
      font-size: 1.8rem;
      color: #ffdd57;
      margin-bottom: 5px;
      line-height: 1.3;
      word-wrap: break-word;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    
    .header p {
      font-size: 1rem;
      opacity: 0.9;
      line-height: 1.4;
      max-width: 800px;
      margin: 0 auto;
    }
    
    /* CONTAINER PRINCIPAL */
    .main-container {
      display: flex;
      flex-direction: column;
      width: 100%;
      max-width: 1400px;
      gap: 20px;
    }
    
    @media (min-width: 992px) {
      .main-container {
        flex-direction: row;
        align-items: flex-start;
      }
    }
    
    /* SECTION CALENDRIER - AGRANDIE */
    .calendar-section {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
    }
    
    /* SELECTEUR DE DATE - NOUVEAU */
    .date-selector {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 15px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      margin-bottom: 15px;
    }
    
    .date-selector h3 {
      color: #ffdd57;
      text-align: center;
      margin-bottom: 12px;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .date-selector-form {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: center;
    }
    
    .date-input-group {
      display: flex;
      flex-direction: column;
      min-width: 0;
      flex: 1;
    }
    
    .date-input-group label {
      font-size: 0.8rem;
      color: #a8e6a8;
      margin-bottom: 4px;
      text-align: center;
    }
    
    .date-input-group select,
    .date-input-group input {
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 6px;
      color: white;
      padding: 8px 12px;
      font-size: 0.95rem;
      min-width: 0;
    }
    
    .date-input-group select:focus,
    .date-input-group input:focus {
      outline: none;
      border-color: #ffdd57;
      box-shadow: 0 0 0 2px rgba(255, 221, 87, 0.3);
    }
    
    .date-input-group input {
      text-align: center;
    }
    
    .date-selector-buttons {
      display: flex;
      gap: 8px;
      margin-top: 5px;
    }
    
    .date-selector-btn {
      background: linear-gradient(to right, #2a7d3e, #1a5c2e);
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }
    
    .date-selector-btn:hover {
      background: linear-gradient(to right, #3a9d4e, #2a7d3e);
    }
    
    .date-selector-btn:active {
      transform: scale(0.98);
    }
    
    .date-selector-btn.primary {
      background: linear-gradient(to right, #ffdd57, #ffcc00);
      color: #1a5c2e;
      font-weight: bold;
    }
    
    .date-selector-btn.primary:hover {
      background: linear-gradient(to right, #ffed77, #ffdc20);
    }
    
    .calendar {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      overflow: hidden;
      border: 2px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }
    
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(to right, #2a7d3e, #1a5c2e);
      padding: 15px 20px;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .nav-btn {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      font-size: 1.5rem;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      flex-shrink: 0;
      transition: all 0.2s;
    }
    
    .nav-btn:disabled {
      background: rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.5);
      cursor: not-allowed;
    }
    
    .nav-btn:not(:disabled):active {
      background: rgba(255, 255, 255, 0.3);
      transform: scale(0.95);
    }
    
    .month-title {
      text-align: center;
      flex: 1;
      min-width: 0;
      padding: 0 15px;
    }
    
    .bassa-month {
      font-size: 1.6rem;
      color: #ffdd57;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-weight: bold;
    }
    
    .nwii-year {
      font-size: 1rem;
      opacity: 0.9;
      margin-top: 3px;
      color: #a8e6a8;
    }
    
    /* GRILLE DU CALENDRIER - AGRANDIE */
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      gap: 0;
      max-height: 500px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    .calendar-grid::-webkit-scrollbar {
      width: 8px;
    }
    
    .calendar-grid::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }
    
    .calendar-grid::-webkit-scrollbar-thumb {
      background: rgba(255, 221, 87, 0.5);
      border-radius: 4px;
    }
    
    .day-cell {
      padding: 12px 6px;
      text-align: center;
      border-right: 1px solid rgba(255, 255, 255, 0.15);
      border-bottom: 1px solid rgba(255, 255, 255, 0.15);
      min-height: 95px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      cursor: pointer;
      background: rgba(255, 255, 255, 0.05);
      transition: background-color 0.2s;
    }
    
    .day-cell:nth-child(10n) {
      border-right: none;
    }
    
    .day-cell:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .day-cell.selected {
      background: rgba(255, 221, 87, 0.25) !important;
      box-shadow: inset 0 0 0 3px #ffdd57;
    }
    
    .day-cell.today {
      background: rgba(255, 221, 87, 0.2) !important;
      box-shadow: inset 0 0 0 2px #ffdd57;
    }
    
    .bassa-day {
      font-size: 1.8rem;
      font-weight: bold;
      color: white;
      margin-bottom: 3px;
    }
    
    .selected .bassa-day,
    .today .bassa-day {
      color: #ffdd57;
      font-size: 2rem;
    }
    
    .tolangwa-name {
      font-size: 0.75rem;
      color: #a8e6a8;
      margin-bottom: 3px;
      font-style: italic;
    }
    
    .ngwa-name {
      font-size: 0.9rem;
      font-weight: bold;
      color: #ffdd57;
      margin-bottom: 4px;
    }
    
    .gregorian-date {
      font-size: 0.8rem;
      background: rgba(255, 255, 255, 0.15);
      padding: 3px 6px;
      border-radius: 5px;
      color: white;
      font-weight: 500;
    }
    
    /* JOURS SP√âCIAUX */
    .special-day {
      position: relative;
      background: rgba(255, 107, 107, 0.1) !important;
    }
    
    .special-day::before {
      content: '‚òÖ';
      position: absolute;
      top: 4px;
      right: 4px;
      font-size: 0.7rem;
      color: #ffdd57;
    }
    
    .new-year-day {
      background: rgba(255, 107, 107, 0.2) !important;
      border: 2px solid rgba(255, 107, 107, 0.4);
    }
    
    /* BOUTON TRADITION - EN BAS DU CALENDRIER */
    .tradition-btn-container {
      margin-top: 15px;
    }
    
    .tradition-btn {
      width: 100%;
      background: linear-gradient(to right, #ffdd57, #ffcc00);
      color: #1a5c2e;
      border: none;
      padding: 16px;
      border-radius: 10px;
      font-size: 1.2rem;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(255, 221, 87, 0.3);
    }
    
    .tradition-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 221, 87, 0.4);
    }
    
    .tradition-btn:active {
      transform: translateY(0);
    }
    
    /* SECTION INFORMATIONS - REMONT√âE VERS LE HAUT */
    .info-section {
      flex: 0 0 400px;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    @media (min-width: 992px) {
      .info-section {
        position: sticky;
        top: 20px;
      }
    }
    
    .info-card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 20px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }
    
    .current-info h2 {
      color: #ffdd57;
      text-align: center;
      margin-bottom: 20px;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .info-item {
      margin-bottom: 12px;
      padding: 10px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 8px;
      border-left: 4px solid #ffdd57;
    }
    
    .info-label {
      font-size: 0.85rem;
      color: #a8e6a8;
      margin-bottom: 3px;
    }
    
    .info-value {
      font-size: 1.2rem;
      color: #ffdd57;
      font-weight: bold;
    }
    
    .info-detail {
      font-size: 0.85rem;
      opacity: 0.9;
      margin-top: 3px;
    }
    
    /* PHASE DE LA LUNE - EN DESSOUS DES INFORMATIONS */
    .moon-section {
      background: rgba(255, 255, 255, 0.08);
      border-radius: 12px;
      padding: 20px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }
    
    .moon-section h3 {
      color: #ffdd57;
      margin-bottom: 15px;
      font-size: 1.3rem;
    }
    
    .moon {
      font-size: 80px;
      margin: 10px 0;
    }
    
    .phase {
      font-size: 1.3rem;
      font-weight: bold;
      color: #ffdd57;
      margin-bottom: 8px;
    }
    
    .moon-info {
      font-size: 0.95rem;
      opacity: 0.9;
    }
    
    /* MODAL TRADITION */
    .tradition-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 1000;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      padding: 20px;
    }
    
    .tradition-content {
      background: linear-gradient(135deg, #0b3d1a 0%, #1a5c2e 100%);
      max-width: 800px;
      margin: 40px auto;
      padding: 30px;
      border-radius: 15px;
      border: 2px solid #ffdd57;
      position: relative;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }
    
    .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      background: #ffdd57;
      color: #1a5c2e;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .tradition-content h2 {
      color: #ffdd57;
      text-align: center;
      margin-bottom: 25px;
      font-size: 1.8rem;
      border-bottom: 2px solid #ffdd57;
      padding-bottom: 10px;
    }
    
    .notes {
      font-size: 1rem;
      line-height: 1.6;
    }
    
    .notes strong {
      color: #ffdd57;
      display: block;
      margin-bottom: 10px;
      font-size: 1.1rem;
    }
    
    .notes blockquote {
      border-left: 4px solid #ffdd57;
      padding: 15px 20px;
      margin: 20px 0;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 0 8px 8px 0;
      font-style: italic;
    }
    
    .notes p {
      margin-bottom: 20px;
    }
    
    /* MESSAGE D'ERREUR */
    .error-message {
      color: #ff6b6b;
      font-size: 0.85rem;
      margin-top: 5px;
      text-align: center;
      display: none;
    }
    
    /* RESPONSIVE */
    @media (max-width: 991px) {
      .calendar-grid {
        grid-template-columns: repeat(5, 1fr);
      }
      
      .day-cell:nth-child(5n) {
        border-right: none;
      }
      
      .day-cell:nth-child(10n) {
        border-right: 1px solid rgba(255, 255, 255, 0.15);
      }
      
      .header h1 {
        font-size: 1.5rem;
      }
      
      .bassa-day {
        font-size: 1.6rem;
      }
      
      .selected .bassa-day,
      .today .bassa-day {
        font-size: 1.8rem;
      }
      
      .info-section {
        flex: 1;
      }
      
      .date-selector-form {
        flex-direction: column;
        align-items: stretch;
      }
      
      .date-input-group {
        width: 100%;
      }
      
      .date-selector-buttons {
        width: 100%;
      }
    }
    
    @media (max-width: 768px) {
      body {
        padding: 8px;
      }
      
      .calendar-grid {
        grid-template-columns: repeat(3, 1fr);
        max-height: 400px;
      }
      
      .day-cell:nth-child(3n) {
        border-right: none;
      }
      
      .day-cell:nth-child(5n), .day-cell:nth-child(10n) {
        border-right: 1px solid rgba(255, 255, 255, 0.15);
      }
      
      .calendar-header {
        padding: 12px 15px;
      }
      
      .nav-btn {
        width: 40px;
        height: 40px;
        font-size: 1.3rem;
      }
      
      .bassa-month {
        font-size: 1.3rem;
      }
      
      .day-cell {
        min-height: 85px;
        padding: 10px 4px;
      }
      
      .tradition-btn {
        padding: 14px;
        font-size: 1.1rem;
      }
      
      .date-selector {
        padding: 12px;
      }
      
      .date-selector h3 {
        font-size: 1rem;
      }
    }
    
    @media (max-width: 480px) {
      .calendar-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .day-cell:nth-child(2n) {
        border-right: none;
      }
      
      .header h1 {
        font-size: 1.3rem;
      }
      
      .bassa-day {
        font-size: 1.4rem;
      }
      
      .day-cell {
        min-height: 80px;
      }
      
      .moon {
        font-size: 60px;
      }
      
      .tradition-btn {
        font-size: 1rem;
        padding: 12px;
      }
      
      .date-selector-buttons {
        flex-direction: column;
      }
    }
    
    /* ANIMATIONS */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .tradition-content {
      animation: fadeIn 0.3s ease-out;
    }
    
    /* SUPPORT POUR TOUCH */
    @supports (-webkit-touch-callout: none) {
      body {
        min-height: -webkit-fill-available;
      }
      
      .calendar-grid,
      .tradition-modal {
        -webkit-overflow-scrolling: touch;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>Calendrier Bassa'a - NGAAKEK KOM BOGA</h1>
    <p>Un calendrier traditionnel bas√© sur le syst√®me 12 mois √ó 3 semaines √ó 10 jours (360 jours/an) + 5 jours de Ngand Babog</p>
  </div>
  
  <div class="main-container">
    <!-- SECTION CALENDRIER AVEC SELECTEUR EN HAUT ET BOUTON EN BAS -->
    <div class="calendar-section">
      <!-- NOUVEAU SELECTEUR DE DATE -->
      <div class="date-selector">
        <h3>üìÖ Aller √† une date pr√©cise</h3>
        <div class="date-selector-form">
          <div class="date-input-group">
            <label for="year-input">Ann√©e NWII</label>
            <input type="number" id="year-input" min="1" max="100000" value="42795" placeholder="Ann√©e NWII">
          </div>
          
          <div class="date-input-group">
            <label for="month-select">Mois Bassa'a</label>
            <select id="month-select">
              <!-- Les mois seront ajout√©s par JavaScript -->
            </select>
          </div>
          
          <div class="date-input-group">
            <label for="day-select">Jour du mois</label>
            <select id="day-select">
              <!-- Les jours seront ajout√©s par JavaScript -->
            </select>
          </div>
          
          <div class="date-selector-buttons">
            <button class="date-selector-btn" id="go-today-btn">
              <span>üìÖ</span> Aujourd'hui
            </button>
            <button class="date-selector-btn primary" id="go-date-btn">
              <span>üöÄ</span> Aller √† cette date
            </button>
          </div>
        </div>
        <div class="error-message" id="date-error"></div>
      </div>
      
      <div class="calendar">
        <div class="calendar-header">
          <button class="nav-btn" id="prev">‚Üê</button>
          <div class="month-title">
            <div class="bassa-month" id="bassa-month-name"></div>
            <div class="nwii-year" id="nwii-year-display"></div>
          </div>
          <button class="nav-btn" id="next">‚Üí</button>
        </div>
        
        <div class="calendar-grid" id="calendar-grid">
          <!-- Les jours seront g√©n√©r√©s par JavaScript -->
        </div>
      </div>
      
      <!-- BOUTON TRADITION - EN BAS DU CALENDRIER -->
      <div class="tradition-btn-container">
        <button class="tradition-btn" id="tradition-btn">
          üìú ‚ü™ Ndeg Ndopol ‚ü´
        </button>
      </div>
    </div>
    
    <!-- SECTION INFORMATIONS - REMONT√âE VERS LE HAUT -->
    <div class="info-section">
      <!-- INFORMATIONS DU JOUR -->
      <div class="info-card current-info">
        <h2>üìÖ Informations du jour</h2>
        
        <div class="info-item">
          <div class="info-label">Ann√©e NWII</div>
          <div class="info-value" id="current-nwii">42795</div>
        </div>
        
        <div class="info-item">
          <div class="info-label">Mois (So≈ã)</div>
          <div class="info-value" id="current-month">K…înd…î≈ã</div>
          <div class="info-detail" id="current-month-detail"></div>
        </div>
        
        <div class="info-item">
          <div class="info-label">D√©cade (Tolangwa)</div>
          <div class="info-value" id="current-tolangwa">Adna</div>
          <div class="info-detail" id="current-tolangwa-detail"></div>
        </div>
        
        <div class="info-item">
          <div class="info-label">Jour (Ngwa)</div>
          <div class="info-value" id="current-ngwa">Njek</div>
          <div class="info-detail" id="current-ngwa-detail"></div>
        </div>
        
        <div class="info-item">
          <div class="info-label">Date dans le mois</div>
          <div class="info-value" id="current-date">3</div>
          <div class="info-detail" id="current-date-detail"></div>
        </div>
        
        <div class="info-item">
          <div class="info-label">Date gr√©gorienne</div>
          <div class="info-value" id="current-gregorian"></div>
        </div>
      </div>
      
      <!-- PHASE DE LA LUNE - EN DESSOUS DES INFORMATIONS -->
      <div class="info-card moon-section">
        <h3>üåô Phase de la Lune</h3>
        <div id="moon" class="moon">üåì</div>
        <div id="phase" class="phase">Premier Quartier</div>
        <div id="illumination" class="moon-info">Illumination : 50%</div>
      </div>
    </div>
  </div>
  
  <!-- MODAL TRADITION -->
  <div class="tradition-modal" id="tradition-modal">
    <div class="tradition-content">
      <button class="close-btn" id="close-modal">&times;</button>
      <h2>‚ü™ Ndeg Ndopol ‚ü´</h2>
      <div class="notes">
        <p><strong>Bassa ba bi bodol a≈ã ni bok ngeda len 42794 nwii</strong><br><br>
        hala we 25 ma bik√®k bi his√≤t (cycles sothiaques) i l√≤ ane i bi farao i be bod√≤l i Kemet.<br>
        K√®k his√≤t yada i n√≤m 1460 nwii.<br>
        I k√®k di y√®, i bi bodle i nwii 42369, len 425 nwii. I ga melel i nwii 43830, len 1036 nwii.<br>
        Hiki hilo bisu hi so≈ã njeba, nwii wada u nkondba.<br>
        Handugi i ndeg mam i, ng√†√†kek i nhen be.</p>

        <p><strong>Nwii u ye nkabag</strong><br><br>
        [1*2 so≈ã] : Njeba, Hika≈ã, Dipos, Bi oom, Ma ye sep, L√¨buy li nyee, Kondo≈ã.<br>
        Macel, Matop, Mart√∫mb, Mpuye, Hil√≤nd√®.</p>

        <blockquote>
          **Dilo di tan, dilo di ngand B√†bog i pola lisuk li nwii ni bi bodle bi nwii yondo : ngwa Sep to le lwiye, ngwa H√≤do, ngwa Hisi, ngwa Lis√†nda ni ngwa K√≤hle.<br>
          **Nge≈ã i samal.<br>
          So≈ã i gwe 30 ma dilo, nkabak tolangw√† i aa.<br>
          Hiki tolangwa i gwe ma ngw√† to le dilo 10 : ngwa Njangumba, ngwa Mbak, ngwa Njek, ngwa Nge, ngwa Um, ngwa Mbok, ngwa Koo, ngwa Jon, ngw√† Bil√†ba, ngw√† Bum.<br>
          Nwii u gwe tolangw√† 36.
        </blockquote>

        <p><strong>Bi yimbne bi samal inyu yi a≈ã ngaakek :</strong><br><br>
        ‚ñ™ Ngwa Njangumba, hilo bisu hi Njeba a ye kel ngand nwii yondo.<br>
        ‚ñ™ Ngwa Koo, hilo 27 hi Hika≈ã a ye kel mbigda nyemb Um Nyobe.<br>
        ‚ñ™ Ngwa Njek, hilo 23 hi Bi oom, a ye kel ngand Mpoo.<br>
        ‚ñ™ Ngwa Bum, hilo 10 hi Libuy li nyee a ye kel ngand ngwo.<br>
        ‚ñ™ Ngwa Koo, hilo 17 hi Libuy li nyee a ye kel mbigda Kunde lon Kamerun.<br>
        ‚ñ™ Ngwa Koo, hilo 17 hi Matop a ye kel ngand nson.
        </p>
        <p><strong>Hilo hi bisu hi so≈ã</strong><br><br>
        Njeba          = 19 juillet<br>
        Hika≈ã          = 18 aout<br>
        Dipos          = 17 septembre<br>
        Bi oom         = 17 octobre<br>
        Ma ye sep      = 16 novembre<br>
        Libuy li nyee  = 16 decembre<br>
        Kondo≈ã         = 15 janvier<br>
        Macel          = 14 fevrier<br>
        Matop          = 15 mars<br>
        Matumb         = 14 avril<br>
        Mpuye          = 14 mai<br>
        Hilonde        = 13 juin<br></p>
      </div>
    </div>
  </div>

  <script>
    // Attendre que la page soit compl√®tement charg√©e
    window.addEventListener('load', function() {
      // DONN√âES FIXES - CORRIG√âES selon les anciens
      const bassaMonths = [
        { name: "K…înd…î≈ã", meaning: "Premier mois de l'ann√©e" },
        { name: "M√†tum", meaning: "Mois des semences" },
        { name: "M√†t…îp", meaning: "Mois des premi√®res pluies" },
        { name: "Mpuy…õ", meaning: "Mois de la croissance" },
        { name: "Hika≈ã", meaning: "Mois de la petite s√©cheresse" },
        { name: "Njeba", meaning: "Mois des pr√©mices" },
        { name: "Libuy li nye", meaning: "Mois des fruits m√ªrs" },
        { name: "M√†t…õl", meaning: "Mois des grandes r√©coltes" },
        { name: "Bi oom", meaning: "Mois des secondes pluies" },
        { name: "Di p…îh", meaning: "Mois des semis tardifs" },
        { name: "M√† y…õ sep", meaning: "Mois de la grande s√©cheresse" },
        { name: "Hilonde", meaning: "Dernier mois de l'ann√©e" }
      ];
      
      const tolangwaNames = [
        "BOD√ëEM", "BILIA", "NG√âN", "SUHUL NYU", "NDAG", "SESEMA", 
        "GW√âHA", "MAYEGNA", "NG√âDI", "MASODA", "LIGIB", "BABOD", 
        "OMSI√ë", "M'BAN", "BABOG", "NWEE", "MAK√âND", "LINGW√âL√âH",
        "ADNA", "MAPUBI", "LIKWEE", "NJI√ëGE", "HOGBE", "LIKE√ëGE", 
        "NIHBE", "MAHOL", "NTOL", "NSA√ë", "LIP√âM", "NJOHA", 
        "NGOO", "MANOGLA", "LIPOYOG", "MAS√â", "LIBO", "LIKAB"
      ];
      
      // CORRECTION: Um et Nge invers√©s, et orthographe corrig√©e
      const ngwaDays = [
        { name: "Njangumba", meaning: "Premier march√©, jour d'ouverture" },
        { name: "Mbak", meaning: "Deuxi√®me jour, jour de force" },
        { name: "Njek", meaning: "Troisi√®me jour, jour d'√©quilibre" },
        { name: "Nge", meaning: "Cinqui√®me jour, pr√©paration" },
        { name: "Um", meaning: "Quatri√®me jour, transition" },
        { name: "Mbok", meaning: "Sixi√®me jour, repos m√©ditatif" },
        { name: "Koo", meaning: "Septi√®me jour, accomplissement" },
        { name: "Jon", meaning: "Huiti√®me jour, cl√¥ture" },
        { name: "Bil√†ba", meaning: "Neuvi√®me jour, appel" },
        { name: "Bum", meaning: "Dixi√®me jour, sacr√©" }
      ];
      
      // JOURS SP√âCIAUX (dates gr√©goriennes) - Pour marquage seulement
      const specialDays = [
        { month: 6, day: 19, event: "F√™te de d√©but d'ann√©e", isNewYear: true },
        { month: 7, day: 27, event: "Mort de Ruben Um Nyobe" },
        { month: 3, day: 23, event: "F√™te Mpoo" },
        { month: 5, day: 10, event: "F√™te du feu" },
        { month: 5, day: 17, event: "R√©volte Kunde" },
        { month: 2, day: 17, event: "F√™te des anc√™tres" }
      ];
      
      // CONSTANTES DU CALENDRIER BASSA'A
      const DAYS_IN_MONTH = 30;
      const DAYS_IN_YEAR = 365;
      const DAYS_IN_COMMON_YEAR = 360;
      const NGAND_DAYS = 5;
      const DAYS_PER_TOLANGWA = 10;
      const TOLANGWA_PER_YEAR = 36;
      const MIN_YEAR = 1;
      const MAX_YEAR = 100000;
      
      // RELATION DE BASE ENTRE LES CALENDRIERS
      // Point de r√©f√©rence principal : 17 janvier 2026 = 3 K…înd…î≈ã 42795
      // Donc : 2026 gr√©gorien = 42795 bassa'a
      // Diff√©rence fixe : 42795 - 2026 = 40769
      const YEAR_DIFFERENCE = 40769; // bassa'a - gr√©gorien
      
      // DATE DE R√âF√âRENCE POUR LES CALCULS DE JOURS
      // Nous avons besoin d'une date de r√©f√©rence absolue
      const REF_GREGORIAN_DATE = new Date(2026, 0, 17); // 17 janvier 2026
      const REF_BASSA_DATE = {
        nwii: 42795,
        month: 0, // K…înd…î≈ã
        dayInMonth: 3,
        dayOfYear: 2 // (0-indexed) : 0 = 1er janvier, 2 = 3 janvier
      };
      
      // √âTAT
      let currentBassaDate;
      let selectedBassaDate;
      let displayedMonth = 0;
      let displayedNwii = 42795;
      
      // √âL√âMENTS DOM
      const elements = {
        calendarGrid: document.getElementById('calendar-grid'),
        bassaMonthName: document.getElementById('bassa-month-name'),
        nwiiYearDisplay: document.getElementById('nwii-year-display'),
        currentNwii: document.getElementById('current-nwii'),
        currentMonth: document.getElementById('current-month'),
        currentMonthDetail: document.getElementById('current-month-detail'),
        currentTolangwa: document.getElementById('current-tolangwa'),
        currentTolangwaDetail: document.getElementById('current-tolangwa-detail'),
        currentNgwa: document.getElementById('current-ngwa'),
        currentNgwaDetail: document.getElementById('current-ngwa-detail'),
        currentDate: document.getElementById('current-date'),
        currentDateDetail: document.getElementById('current-date-detail'),
        currentGregorian: document.getElementById('current-gregorian'),
        prevBtn: document.getElementById('prev'),
        nextBtn: document.getElementById('next'),
        traditionBtn: document.getElementById('tradition-btn'),
        traditionModal: document.getElementById('tradition-modal'),
        closeModal: document.getElementById('close-modal'),
        // Nouveaux √©l√©ments pour le s√©lecteur de date
        yearInput: document.getElementById('year-input'),
        monthSelect: document.getElementById('month-select'),
        daySelect: document.getElementById('day-select'),
        goTodayBtn: document.getElementById('go-today-btn'),
        goDateBtn: document.getElementById('go-date-btn'),
        dateError: document.getElementById('date-error')
      };
      
      // ==============================================
      // FONCTIONS DE CONVERSION ANN√âES
      // ==============================================
      
      function bassaToGregorianYear(bassaYear) {
        // Simple soustraction : ann√©e gr√©gorienne = ann√©e bassa - 40769
        return bassaYear - YEAR_DIFFERENCE;
      }
      
      function gregorianToBassaYear(gregorianYear) {
        // Simple addition : ann√©e bassa = ann√©e gr√©gorienne + 40769
        return gregorianYear + YEAR_DIFFERENCE;
      }
      
      function formatGregorianYear(year) {
        if (year < 1) {
          return Math.abs(year - 1) + " A.V.J.C.";
        }
        return year;
      }
      
      // ==============================================
      // FONCTIONS DE CALCUL DE DATES (NOUVELLES)
      // ==============================================
      
      function calculateDaysBetweenBassaDates(startDate, endDate) {
        // Calcule le nombre de jours entre deux dates Bassa'a
        // Une date Bassa'a = {nwii, month, dayInMonth}
        
        // Convertir chaque date en nombre total de jours depuis l'ann√©e 0
        function dateToDays(date) {
          // Ann√©es compl√®tes avant cette ann√©e
          let totalDays = date.nwii * DAYS_IN_COMMON_YEAR;
          
          // Ajouter les jours des ann√©es Ngand (5 jours par an)
          totalDays += date.nwii * NGAND_DAYS;
          
          // Ajouter les jours des mois dans l'ann√©e en cours
          totalDays += date.month * DAYS_IN_MONTH;
          
          // Ajouter les jours dans le mois
          totalDays += (date.dayInMonth - 1);
          
          return totalDays;
        }
        
        return dateToDays(endDate) - dateToDays(startDate);
      }
      
      function calculateGregorianDateFromBassa(bassaDate) {
        // Convertit une date Bassa'a en date gr√©gorienne
        // 1. Calculer la diff√©rence en ann√©es entre la date Bassa'a et la r√©f√©rence
        const yearsDiff = bassaDate.nwii - REF_BASSA_DATE.nwii;
        
        // 2. Calculer la diff√©rence en jours dans l'ann√©e
        const startDayOfYear = REF_BASSA_DATE.month * DAYS_IN_MONTH + (REF_BASSA_DATE.dayInMonth - 1);
        const endDayOfYear = bassaDate.month * DAYS_IN_MONTH + (bassaDate.dayInMonth - 1);
        
        // 3. Nombre total de jours de diff√©rence
        let totalDaysDiff = yearsDiff * DAYS_IN_YEAR; // 365 jours par an
        
        // Ajouter les jours de diff√©rence dans l'ann√©e
        totalDaysDiff += (endDayOfYear - startDayOfYear);
        
        // 4. Cr√©er une nouvelle date gr√©gorienne en ajoutant la diff√©rence
        const gregorianDate = new Date(REF_GREGORIAN_DATE);
        gregorianDate.setDate(gregorianDate.getDate() + totalDaysDiff);
        
        return gregorianDate;
      }
      
      function calculateBassaDateFromGregorian(gregorianDate) {
        // Convertit une date gr√©gorienne en date Bassa'a
        // 1. Diff√©rence en jours depuis la r√©f√©rence
        const diffDays = Math.floor((gregorianDate - REF_GREGORIAN_DATE) / (1000 * 60 * 60 * 24));
        
        // 2. Calculer le nombre d'ann√©es Bassa'a compl√®tes
        const yearsFromRef = Math.floor(diffDays / DAYS_IN_YEAR);
        
        // 3. Ann√©e Bassa'a r√©sultante
        const nwii = REF_BASSA_DATE.nwii + yearsFromRef;
        
        // 4. Jours restants dans l'ann√©e en cours
        let daysInCurrentYear = diffDays - (yearsFromRef * DAYS_IN_YEAR);
        daysInCurrentYear += (REF_BASSA_DATE.month * DAYS_IN_MONTH + (REF_BASSA_DATE.dayInMonth - 1));
        
        // Ajuster si n√©gatif
        if (daysInCurrentYear < 0) {
          daysInCurrentYear += DAYS_IN_YEAR;
        }
        
        // 5. D√©terminer si c'est un jour Ngand (jours 361-365)
        let month, dayInMonth;
        
        if (daysInCurrentYear >= 360) {
          // Jour Ngand
          month = 11; // Hilonde
          dayInMonth = 30 + (daysInCurrentYear - 360 + 1);
        } else {
          // Jour normal
          month = Math.floor(daysInCurrentYear / DAYS_IN_MONTH);
          dayInMonth = (daysInCurrentYear % DAYS_IN_MONTH) + 1;
        }
        
        return {
          nwii: nwii,
          month: month,
          dayInMonth: dayInMonth,
          gregorianDate: gregorianDate
        };
      }
      
      // ==============================================
      // FONCTIONS DE CALCUL DES INFORMATIONS
      // ==============================================
      
      function getBassaDateDetails(bassaDate) {
        // Calcule toutes les informations pour une date Bassa'a
        const dayInYear = (bassaDate.month * DAYS_IN_MONTH) + (bassaDate.dayInMonth - 1);
        const tolangwaInYear = Math.floor(dayInYear / DAYS_PER_TOLANGWA);
        const tolangwaIndex = tolangwaInYear % TOLANGWA_PER_YEAR;
        const ngwaIndex = (bassaDate.dayInMonth - 1) % DAYS_PER_TOLANGWA;
        
        // Calculer la date gr√©gorienne CORRECTE
        const gregorianDate = calculateGregorianDateFromBassa(bassaDate);
        const gregorianYear = gregorianDate.getFullYear();
        
        return {
          nwii: bassaDate.nwii,
          month: bassaDate.month,
          dayInMonth: bassaDate.dayInMonth,
          tolangwaIndex: tolangwaIndex,
          tolangwaName: tolangwaNames[tolangwaIndex],
          ngwaIndex: ngwaIndex,
          ngwaName: ngwaDays[ngwaIndex].name,
          ngwaMeaning: ngwaDays[ngwaIndex].meaning,
          gregorianDate: gregorianDate,
          gregorianYear: gregorianYear,
          isNgand: bassaDate.dayInMonth > 30,
          dayInYear: dayInYear
        };
      }
      
      function isSpecialDay(gregorianDate) {
        const month = gregorianDate.getMonth();
        const day = gregorianDate.getDate();
        return specialDays.some(special => special.month === month && special.day === day);
      }
      
      function isNewYearDay(bassaDate) {
        return bassaDate.month === 0 && bassaDate.dayInMonth === 1;
      }
      
      // ==============================================
      // FONCTIONS DE V√âRIFICATION DES LIMITES
      // ==============================================
      
      function isWithinBounds(nwii, month) {
        if (nwii < MIN_YEAR || nwii > MAX_YEAR) return false;
        if (nwii === MIN_YEAR && month < 0) return false;
        if (nwii === MAX_YEAR && month > 11) return false;
        return true;
      }
      
      function updateNavButtons() {
        elements.prevBtn.disabled = !isWithinBounds(displayedNwii, displayedMonth - 1);
        elements.nextBtn.disabled = !isWithinBounds(displayedNwii, displayedMonth + 1);
      }
      
      // ==============================================
      // FONCTIONS DU SELECTEUR DE DATE
      // ==============================================
      
      function initDateSelector() {
        // Remplir la liste des mois
        bassaMonths.forEach((month, index) => {
          const option = document.createElement('option');
          option.value = index;
          option.textContent = month.name;
          elements.monthSelect.appendChild(option);
        });
        
        // Remplir la liste des jours (1 √† 30)
        for (let i = 1; i <= 30; i++) {
          const option = document.createElement('option');
          option.value = i;
          option.textContent = i;
          elements.daySelect.appendChild(option);
        }
        
        // Mettre √† jour les valeurs avec la date actuelle
        updateDateSelector();
        
        // √âcouter les changements
        elements.yearInput.addEventListener('change', validateYearInput);
        elements.monthSelect.addEventListener('change', updateDaySelect);
        elements.goTodayBtn.addEventListener('click', goToToday);
        elements.goDateBtn.addEventListener('click', goToSelectedDate);
        
        // Touche Entr√©e dans l'ann√©e
        elements.yearInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            goToSelectedDate();
          }
        });
      }
      
      function validateYearInput() {
        const year = parseInt(elements.yearInput.value);
        let error = '';
        
        if (isNaN(year)) {
          error = 'Veuillez entrer une ann√©e valide';
        } else if (year < MIN_YEAR || year > MAX_YEAR) {
          error = `L'ann√©e doit √™tre entre ${MIN_YEAR} et ${MAX_YEAR}`;
        }
        
        if (error) {
          showDateError(error);
          return false;
        } else {
          hideDateError();
          return true;
        }
      }
      
      function updateDateSelector() {
        // Synchroniser avec le calendrier affich√©
        elements.yearInput.value = displayedNwii;
        elements.monthSelect.value = displayedMonth;
        
        // Si une date est s√©lectionn√©e, mettre √† jour le jour
        if (selectedBassaDate && 
            selectedBassaDate.nwii === displayedNwii && 
            selectedBassaDate.month === displayedMonth) {
          elements.daySelect.value = selectedBassaDate.dayInMonth;
        } else {
          // Sinon, s√©lectionner le premier jour
          elements.daySelect.value = 1;
        }
        
        // Valider l'ann√©e
        validateYearInput();
      }
      
      function updateDaySelect() {
        hideDateError();
      }
      
      function goToToday() {
        const today = new Date();
        const bassaToday = calculateBassaDateFromGregorian(today);
        
        displayedMonth = bassaToday.month;
        displayedNwii = bassaToday.nwii;
        
        renderCalendar();
        updateDateSelector();
        hideDateError();
        
        // S√©lectionner le jour d'aujourd'hui
        const todayCell = elements.calendarGrid.children[bassaToday.dayInMonth - 1];
        if (todayCell) {
          todayCell.click();
        }
      }
      
      function goToSelectedDate() {
        if (!validateYearInput()) return;
        
        const year = parseInt(elements.yearInput.value);
        const month = parseInt(elements.monthSelect.value);
        const day = parseInt(elements.daySelect.value);
        
        // Validation des donn√©es
        if (year < MIN_YEAR || year > MAX_YEAR) {
          showDateError(`L'ann√©e doit √™tre entre ${MIN_YEAR} et ${MAX_YEAR}`);
          return;
        }
        
        if (month < 0 || month > 11) {
          showDateError('Mois invalide');
          return;
        }
        
        if (day < 1 || day > 30) {
          showDateError('Jour invalide');
          return;
        }
        
        // Mettre √† jour l'affichage
        displayedMonth = month;
        displayedNwii = year;
        
        renderCalendar();
        
        // Cr√©er la date Bassa'a et s√©lectionner le jour
        const bassaDate = {
          nwii: year,
          month: month,
          dayInMonth: day
        };
        
        const dateDetails = getBassaDateDetails(bassaDate);
        selectedBassaDate = {
          ...bassaDate,
          tolangwaIndex: dateDetails.tolangwaIndex,
          tolangwaName: dateDetails.tolangwaName,
          ngwaIndex: dateDetails.ngwaIndex,
          ngwaName: dateDetails.ngwaName,
          ngwaMeaning: dateDetails.ngwaMeaning,
          gregorianDate: dateDetails.gregorianDate
        };
        
        // Mettre √† jour les informations du jour
        updateCurrentDateDisplay(selectedBassaDate);
        
        // S√©lectionner visuellement le jour
        const dayCell = elements.calendarGrid.children[day - 1];
        if (dayCell) {
          document.querySelectorAll('.day-cell.selected').forEach(cell => {
            cell.classList.remove('selected');
          });
          dayCell.classList.add('selected');
        }
        
        hideDateError();
      }
      
      function showDateError(message) {
        elements.dateError.textContent = message;
        elements.dateError.style.display = 'block';
      }
      
      function hideDateError() {
        elements.dateError.style.display = 'none';
      }
      
      // ==============================================
      // FONCTIONS D'AFFICHAGE
      // ==============================================
      
      function updateCurrentDateDisplay(date) {
        if (!date) return;
        
        const dateDetails = getBassaDateDetails(date);
        
        elements.currentNwii.textContent = dateDetails.nwii;
        elements.currentMonth.textContent = bassaMonths[dateDetails.month].name;
        elements.currentMonthDetail.textContent = bassaMonths[dateDetails.month].meaning;
        elements.currentTolangwa.textContent = dateDetails.tolangwaName;
        elements.currentTolangwaDetail.textContent = `D√©cade ${dateDetails.tolangwaIndex + 1} de l'ann√©e`;
        elements.currentNgwa.textContent = dateDetails.ngwaName;
        elements.currentNgwaDetail.textContent = dateDetails.ngwaMeaning;
        elements.currentDate.textContent = dateDetails.dayInMonth;
        elements.currentDateDetail.textContent = `Jour ${dateDetails.dayInMonth} du mois`;
        
        // Formater la date gr√©gorienne CORRECTEMENT
        const gregorianDate = dateDetails.gregorianDate;
        const gregorianYear = gregorianDate.getFullYear();
        const formattedYear = formatGregorianYear(gregorianYear);
        
        // Formater la date compl√®te
        const dayNames = ["dimanche", "lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi"];
        const monthNames = ["janvier", "f√©vrier", "mars", "avril", "mai", "juin", "juillet", "ao√ªt", "septembre", "octobre", "novembre", "d√©cembre"];
        
        const dayOfWeek = dayNames[gregorianDate.getDay()];
        const dayOfMonth = gregorianDate.getDate();
        const monthName = monthNames[gregorianDate.getMonth()];
        
        const gregorianFormatted = `${dayOfWeek} ${dayOfMonth} ${monthName} ${formattedYear}`;
        
        elements.currentGregorian.textContent = gregorianFormatted;
      }
      
      function renderCalendar() {
        elements.bassaMonthName.textContent = bassaMonths[displayedMonth].name;
        elements.nwiiYearDisplay.textContent = `NWII ${displayedNwii} - ${bassaMonths[displayedMonth].name}`;
        
        elements.calendarGrid.innerHTML = '';
        
        const todayBassa = calculateBassaDateFromGregorian(new Date());
        const isCurrentMonth = displayedMonth === todayBassa.month && displayedNwii === todayBassa.nwii;
        
        for (let day = 1; day <= 30; day++) {
          const dayBassaDate = {
            nwii: displayedNwii,
            month: displayedMonth,
            dayInMonth: day
          };
          
          const dayInYear = (displayedMonth * DAYS_IN_MONTH) + (day - 1);
          const tolangwaInYear = Math.floor(dayInYear / DAYS_PER_TOLANGWA);
          const tolangwaIndex = tolangwaInYear % TOLANGWA_PER_YEAR;
          const ngwaIndex = (day - 1) % DAYS_PER_TOLANGWA;
          
          const isToday = isCurrentMonth && day === todayBassa.dayInMonth;
          const isSelected = selectedBassaDate && 
                            selectedBassaDate.month === displayedMonth && 
                            selectedBassaDate.nwii === displayedNwii && 
                            selectedBassaDate.dayInMonth === day;
          
          // Calculer la date gr√©gorienne CORRECTE
          const gregorianDate = calculateGregorianDateFromBassa(dayBassaDate);
          const isSpecial = isSpecialDay(gregorianDate);
          const isNewYear = isNewYearDay(dayBassaDate);
          
          const dayCell = document.createElement('div');
          dayCell.className = 'day-cell';
          if (isToday) dayCell.classList.add('today');
          if (isSelected) dayCell.classList.add('selected');
          if (isSpecial) dayCell.classList.add('special-day');
          if (isNewYear) dayCell.classList.add('new-year-day');
          
          // Formater la date gr√©gorienne pour l'affichage dans la cellule
          const gregorianFormatted = gregorianDate.toLocaleDateString('fr-FR', {
            day: 'numeric',
            month: 'short'
          });
          
          dayCell.innerHTML = `
            <div class="bassa-day">${day}</div>
            <div class="tolangwa-name">${tolangwaNames[tolangwaIndex]}</div>
            <div class="ngwa-name">${ngwaDays[ngwaIndex].name}</div>
            <div class="gregorian-date">${gregorianFormatted}</div>
          `;
          
          // Stocker les donn√©es dans l'√©l√©ment
          dayCell.dataset.bassaDate = JSON.stringify({
            nwii: displayedNwii,
            month: displayedMonth,
            dayInMonth: day,
            tolangwaIndex: tolangwaIndex,
            ngwaIndex: ngwaIndex
          });
          
          dayCell.addEventListener('click', function() {
            const bassaData = JSON.parse(this.dataset.bassaDate);
            const gregorianDate = calculateGregorianDateFromBassa(bassaData);
            const selectedDate = {
              ...bassaData,
              gregorianDate: gregorianDate
            };
            
            // Calculer les informations compl√®tes
            const dateDetails = getBassaDateDetails(selectedDate);
            selectedBassaDate = {
              ...selectedDate,
              tolangwaName: dateDetails.tolangwaName,
              ngwaName: dateDetails.ngwaName,
              ngwaMeaning: dateDetails.ngwaMeaning
            };
            
            // Mettre √† jour l'affichage
            updateCurrentDateDisplay(selectedBassaDate);
            updateDateSelector();
            
            // Mettre √† jour la s√©lection visuelle
            document.querySelectorAll('.day-cell.selected').forEach(cell => {
              cell.classList.remove('selected');
            });
            this.classList.add('selected');
          });
          
          elements.calendarGrid.appendChild(dayCell);
        }
        
        // S√©lectionner automatiquement aujourd'hui si c'est le bon mois
        if (isCurrentMonth && (!selectedBassaDate || selectedBassaDate.nwii !== displayedNwii || selectedBassaDate.month !== displayedMonth)) {
          const todayCell = elements.calendarGrid.children[todayBassa.dayInMonth - 1];
          if (todayCell) {
            todayCell.click();
          }
        } else if (selectedBassaDate && 
                  selectedBassaDate.nwii === displayedNwii && 
                  selectedBassaDate.month === displayedMonth) {
          // Res√©lectionner la date pr√©c√©demment s√©lectionn√©e
          const selectedCell = elements.calendarGrid.children[selectedBassaDate.dayInMonth - 1];
          if (selectedCell) {
            document.querySelectorAll('.day-cell.selected').forEach(cell => {
              cell.classList.remove('selected');
            });
            selectedCell.classList.add('selected');
          }
        }
        
        // Mettre √† jour le s√©lecteur de date
        updateDateSelector();
        
        // Mettre √† jour les boutons de navigation
        updateNavButtons();
      }
      
      // ==============================================
      // PHASE DE LA LUNE
      // ==============================================
      
      function updateMoonPhase() {
        const today = new Date();
        const phase = moonPhase(today);
        const percent = Math.round((1 - Math.cos(2 * Math.PI * phase / 29.53)) * 50);
        
        let name = "", emoji = "";
        
        if (phase < 1.84566) {
          name = "Nouvelle Lune"; emoji = "üåë";
        } else if (phase < 5.53699) {
          name = "Premier Croissant"; emoji = "üåí";
        } else if (phase < 9.22831) {
          name = "Premier Quartier"; emoji = "üåì";
        } else if (phase < 12.91963) {
          name = "Gibbeuse Croissante"; emoji = "üåî";
        } else if (phase < 16.61096) {
          name = "Pleine Lune"; emoji = "üåï";
        } else if (phase < 20.30228) {
          name = "Gibbeuse D√©croissante"; emoji = "üåñ";
        } else if (phase < 23.99361) {
          name = "Dernier Quartier"; emoji = "üåó";
        } else {
          name = "Dernier Croissant"; emoji = "üåò";
        }
        
        document.getElementById("moon").textContent = emoji;
        document.getElementById("phase").textContent = name;
        document.getElementById("illumination").textContent = "Illumination : " + percent + "%";
      }
      
      function moonPhase(date) {
        const synodicMonth = 29.530588853;
        const referenceNewMoon = new Date("2000-01-06T18:14:00Z");
        const days = (date - referenceNewMoon) / 86400000;
        return ((days % synodicMonth) + synodicMonth) % synodicMonth;
      }
      
      // ==============================================
      // GESTION DU MODAL TRADITION
      // ==============================================
      
      elements.traditionBtn.addEventListener('click', function() {
        elements.traditionModal.style.display = 'block';
        document.body.style.overflow = 'hidden';
      });
      
      elements.closeModal.addEventListener('click', function() {
        elements.traditionModal.style.display = 'none';
        document.body.style.overflow = 'auto';
      });
      
      // Fermer le modal en cliquant √† l'ext√©rieur
      elements.traditionModal.addEventListener('click', function(event) {
        if (event.target === elements.traditionModal) {
          elements.traditionModal.style.display = 'none';
          document.body.style.overflow = 'auto';
        }
      });
      
      // ==============================================
      // NAVIGATION AVEC LES FL√àCHES
      // ==============================================
      
      elements.prevBtn.addEventListener('click', function() {
        if (this.disabled) return;
        
        displayedMonth--;
        if (displayedMonth < 0) {
          displayedMonth = 11;
          displayedNwii--;
        }
        
        // V√©rifier les limites
        if (!isWithinBounds(displayedNwii, displayedMonth)) {
          displayedNwii = MIN_YEAR;
          displayedMonth = 0;
        }
        
        renderCalendar();
      });
      
      elements.nextBtn.addEventListener('click', function() {
        if (this.disabled) return;
        
        displayedMonth++;
        if (displayedMonth > 11) {
          displayedMonth = 0;
          displayedNwii++;
        }
        
        // V√©rifier les limites
        if (!isWithinBounds(displayedNwii, displayedMonth)) {
          displayedNwii = MAX_YEAR;
          displayedMonth = 11;
        }
        
        renderCalendar();
      });
      
      // Support tactile pour navigation
      elements.prevBtn.addEventListener('touchstart', function(e) {
        e.preventDefault();
        if (!this.disabled) {
          this.style.transform = 'scale(0.95)';
        }
      });
      
      elements.prevBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        this.style.transform = '';
        if (!this.disabled) {
          this.click();
        }
      });
      
      elements.nextBtn.addEventListener('touchstart', function(e) {
        e.preventDefault();
        if (!this.disabled) {
          this.style.transform = 'scale(0.95)';
        }
      });
      
      elements.nextBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        this.style.transform = '';
        if (!this.disabled) {
          this.click();
        }
      });
      
      // ==============================================
      // INITIALISATION
      // ==============================================
      
      function init() {
        // Calculer la date d'aujourd'hui
        const today = new Date();
        currentBassaDate = calculateBassaDateFromGregorian(today);
        
        displayedMonth = currentBassaDate.month;
        displayedNwii = currentBassaDate.nwii;
        
        // Initialiser le s√©lecteur de date
        initDateSelector();
        
        // Initialiser avec la date d'aujourd'hui
        selectedBassaDate = currentBassaDate;
        updateCurrentDateDisplay(currentBassaDate);
        
        renderCalendar();
        updateMoonPhase();
        
        // Mettre √† jour l'heure toutes les minutes
        setInterval(function() {
          const now = new Date();
          currentBassaDate = calculateBassaDateFromGregorian(now);
          
          // Si nous affichons le mois en cours, mettre √† jour
          if (displayedMonth === currentBassaDate.month && displayedNwii === currentBassaDate.nwii) {
            renderCalendar();
          }
        }, 60000);
        
        // Mettre √† jour la phase de la lune toutes les heures
        setInterval(updateMoonPhase, 3600000);
      }
      
      // D√âMARRER
      init();
      
      // Fonctions de d√©bogage (√† supprimer en production)
      window.debugConversion = function(bassaYear) {
        const gregYear = bassaToGregorianYear(bassaYear);
        console.log(`Bassa'a ${bassaYear} = Gr√©gorien ${gregYear} (${gregYear < 1 ? Math.abs(gregYear - 1) + " A.V.J.C." : gregYear})`);
        return gregYear;
      };
    });
  </script>
</body>
</html>